<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title></title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <script src="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=5"></script>
      <script>
         var map = null;
         var layerid=1;
         
         function GetMap()
         {
            map = new VEMap('myMap');
            map.LoadMap();
         }   

         function AddMyLayer(source)
         {
            alert(VEDataType.GeoRSS);
			alert(source);
			var l = new VEShapeLayer();
            var veLayerSpec = new VEShapeSourceSpecification(VEDataType.GeoRSS, source, l);
            map.ImportShapeLayerData(veLayerSpec, onFeedLoad, 1);
         }
         function onFeedLoad(feed)
         {
            alert('RSS or Collection loaded. There are '+feed.GetShapeCount()+' items in this list.');
         }
      </script>
   </head>
   <body onload="GetMap();">
   		<br /><br /><br /><br />
		<center>
      	<div id='myMap' style="position:relative; width:500px; height:400px; border:1px solid #979797;"></div>
		<br /><br />
      	<INPUT id="txtSource" type="text" value="Expedia_GeoRSS.xml" name="txtSource">
      	<INPUT id="loadFeed" type="button" value="Load RSS" onclick="AddMyLayer('Expedia_GeoRSS.xml');">
		</center>
   </body>
</html>